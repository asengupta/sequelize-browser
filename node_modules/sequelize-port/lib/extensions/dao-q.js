define(function (require, exports, module) {
var DAO   = require("../dao");
var Q = require('npm-loader!q');

(function() {
DAO.prototype.saveQ = function() {
    var args = Array.prototype.slice.apply(arguments);
    var err = this.validate();
    if (err) {
        return Q.fcall(function() {throw err;});
    }
    else {
        return Q.ninvoke(this.save.apply(this, args), 'done');
    }
};

DAO.prototype.updateAttributesQ = function() {
    var args = Array.prototype.slice.apply(arguments);
    var err = this.validate();
    if (err) {
        return Q.fcall(function() {throw err;});
    }
    else {
        return Q.ninvoke(this.updateAttributes.apply(this, args), 'done');
    }
};

DAO.prototype.getAssociatedQ = function(associationName) {
    return Q.ninvoke(this["get" + associationName].apply(this), 'done');
};

DAO.prototype.destroyQ = function() {
    var args = Array.prototype.slice.apply(arguments);
    return Q.ninvoke(this.destroy.apply(this, args), 'done');
};

module.exports = DAO;
return DAO;
})();
});
